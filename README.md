# WAF ModSecurity Test System

Система для быстрого тестирования эффективности правил ModSecurity на nginx.

## Быстрый старт

### 1. Установка зависимостей

`pip install -r requirements.txt`


### 2. Запуск программы

`python main.py`

Программа запросит:
- Адрес целевого сервера (по умолчанию: http://192.168.1.25)
- Путь к логу ModSecurity (по умолчанию: /var/log/modsecurity/modsec_audit.log)

### 3. Результаты

После выполнения будут созданы файлы:
- `waf_test_report.txt` - красивый текстовый отчёт
- `waf_test_report.json` - результаты в JSON формате

## Что тестируется

Система проверяет **36 различных тестовых запросов**:

- **SQL Injection** (10 payload) - попытки внедрения SQL команд
- **XSS** (10 payload) - попытки внедрения JavaScript кода
- **Command Injection** (8 payload) - попытки выполнения системных команд
- **Path Traversal** (8 payload) - попытки обхода директорий

## Как это работает

1. **Проверка соединения** - убеждаемся, что целевой сервер доступен
2. **Генерация payload** - создаём 36 различных тестовых запросов
3. **Отправка запросов** - параллельно отправляем все payload на сервер (5 одновременно)
4. **Сбор результатов** - читаем логи ModSecurity для определения блокировок
5. **Анализ данных** - подсчитываем статистику по типам атак и правилам
6. **Генерация отчёта** - создаём красивый отчёт с результатами

## Требования к окружению

- Python 3.8 или выше
- Nginx с установленным ModSecurity
- Включённое JSON логирование ModSecurity
- Доступность логов: `/var/log/modsecurity/modsec_audit.log`

## Структура файлов

waf_tester/
├── main.py # Точка входа
├── config.py # Конфигурация
├── payloads.py # Тестовые payload
├── waf_tester.py # Главный класс
├── report.py # Генерация отчётов
├── requirements.txt # Зависимости
├── README.md # Документация
├── waf_test_report.txt # Текстовый отчёт (создаётся при запуске)
└── waf_test_report.json # JSON отчёт (создаётся при запуске)

text

## Конфигурация

Отредактируйте `config.py` если нужны другие параметры:

TARGET_URL = "http://192.168.1.25" # Адрес целевого сервера
NGINX_LOG_FILE = "/var/log/modsecurity/modsec_audit.log" # Путь к логам
CONCURRENT_REQUESTS = 5 # Количество одновременных запросов
REQUEST_TIMEOUT = 10 # Таймаут запроса в секундах


## Интерпретация результатов

### Detection Rate (Процент обнаружения)

- **90-100%** ✓ Отлично - WAF хорошо защищён
- **70-89%** ⚠ Хорошо - требуется оптимизация
- **50-69%** ⚠ Удовлетворительно - требуется доработка
- **<50%** ✗ Критично - серьёзная проблема с защитой

### Пропущенные атаки

Список payload, которые НЕ были заблокированы. Это может означать:
- Недостаточные правила для этого типа атаки
- Неправильная кодировка payload
- Необходимо пересмотреть конфигурацию ModSecurity

## Использование результатов

JSON отчёт можно использовать для:
- Автоматизированного мониторинга эффективности WAF
- Интеграции с системами мониторинга (Zabbix, Grafana и т.д.)
- Отслеживания изменений при обновлении правил

